<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Country Manager - Cozy Civic</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <main class="shell">
      <header class="hud">
        <div>
          <p class="eyebrow">Cozy Civic Mode</p>
          <h1>Country Manager</h1>
        </div>
        <div class="hud-metrics">
          <div class="pill traffic-pill" id="trafficPill" title="City health status">
            <span>Status</span><strong id="trafficLight">ðŸŸ¢</strong>
          </div>
          <div class="pill"><span>Tier</span><strong id="tierLabel">City</strong></div>
          <div class="pill"><span>Day</span><strong id="dayLabel">0</strong></div>
          <div class="pill"><span>Stability</span><strong id="stabilityLabel">0%</strong></div>
          <div class="pill"><span>Treasury ($m)</span><strong id="treasuryLabel">$0m</strong></div>
          <div class="pill" title="Action Points are used for upgrades, budget changes, and emergency interventions. They regenerate every 4 days and via streaks/goals."><span>Action Pts</span><strong id="actionPoints">0</strong></div>
          <div class="pill"><span>Streak</span><strong id="streakLabel">0</strong></div>
          <div class="pill"><span>Civilians</span><strong id="civilianCount">0</strong></div>
          <div class="pill"><span>Incidents</span><strong id="incidentCount">0</strong></div>
          <button id="focusBtn" class="btn">Focus: Off</button>
          <button id="pauseBtn" class="btn">Pause</button>
        </div>
      </header>
      <div id="apFeedback" class="ap-feedback" aria-live="polite"></div>
      <div id="decisionFlash" class="decision-flash" aria-live="polite"></div>

      <section id="statusBanner" class="status-banner">City systems nominal.</section>
      <section id="actionDock" class="action-dock card" hidden></section>

      <section class="game-layout">
        <section class="map-panel card">
          <canvas id="isoCanvas" width="1280" height="760"></canvas>
          <aside id="setupOverlay" class="setup-overlay">
            <p class="eyebrow">Founding Phase</p>
            <h3 id="setupTitle">Build Your Government</h3>
            <p id="setupBody" class="muted">Place all core departments before simulation time begins. No incidents or budget drift occur until launch.</p>
            <div class="actions">
              <button id="startPlacementBtn" class="btn">Open Build Queue</button>
              <button id="launchGovBtn" class="btn primary" disabled>Launch Government</button>
            </div>
          </aside>
          <aside id="tutorialOverlay" class="tutorial-overlay" hidden>
            <p id="tutorialKicker" class="eyebrow">Guided Command</p>
            <h3 id="tutorialTitle">Step 1</h3>
            <p id="tutorialBody" class="muted">Follow the guided setup to learn systems before full chaos unlocks.</p>
            <div id="tutorialProgress" class="tutorial-progress"></div>
            <div class="actions">
              <button id="tutorialFocusBtn" class="btn primary">Show Me</button>
              <button id="tutorialSkipBtn" class="btn">Skip Guide</button>
            </div>
          </aside>
          <aside id="majorEventCard" class="major-event-card" hidden>
            <p class="eyebrow">Major Event</p>
            <h3 id="majorEventTitle">No major event</h3>
            <p id="majorEventBody" class="muted"></p>
            <p id="majorEventHint" class="muted"></p>
            <div class="mini-grid">
              <div><span>Window</span><strong id="majorEventTimer">-</strong></div>
              <div><span>Impact</span><strong id="majorEventImpact">-</strong></div>
            </div>
            <div class="actions">
              <button id="majorEventRespondBtn" class="btn primary">Fund Response</button>
              <button id="majorEventDismissBtn" class="btn">Defer</button>
            </div>
          </aside>
          <aside id="housingCard" class="major-event-card housing-card" hidden>
            <p class="eyebrow">Housing Mandate</p>
            <h3 id="housingTitle">New Housing Development</h3>
            <p id="housingBody" class="muted"></p>
            <div class="mini-grid">
              <div><span>Window</span><strong id="housingTimer">-</strong></div>
              <div><span>Effect</span><strong id="housingImpact">-</strong></div>
            </div>
            <div class="actions">
              <button id="housingBtnSmall" class="btn">2x2</button>
              <button id="housingBtnMedium" class="btn">3x3</button>
              <button id="housingBtnLarge" class="btn">4x4</button>
              <button id="housingBtnDefer" class="btn">Defer</button>
            </div>
          </aside>
          <div id="mapTip" class="map-tip">Drag to pan. Scroll to zoom. Place departments on highlighted tiles, then tackle flashing MAJOR beacons and incidents.</div>
        </section>

        <aside class="side-panel">
          <nav class="tab-bar card">
            <button class="btn side-tab is-active" data-tab="control">Control <span id="tabControlAlert" class="tab-alert" hidden>!</span></button>
            <button class="btn side-tab" data-tab="incidents">Incidents <span id="tabIncidentsAlert" class="tab-alert" hidden>!</span></button>
            <button class="btn side-tab" data-tab="pulse">Pulse <span id="tabPulseAlert" class="tab-alert" hidden>!</span></button>
            <button class="btn side-tab" data-tab="people">People <span id="tabPeopleAlert" class="tab-alert" hidden>!</span></button>
            <button class="btn side-tab" data-tab="missions">Missions <span id="tabMissionsAlert" class="tab-alert" hidden>!</span></button>
          </nav>

          <div class="tab-panes">
            <section class="tab-pane is-active" data-pane="control">
              <section class="card collapsible-card" id="buildQueueCard">
                <div class="card-head">
                  <h2>Build Queue</h2>
                  <button class="btn collapse-btn" data-target="buildQueueCard">Minimize</button>
                </div>
                <div class="card-body">
                  <p class="muted">Pick a department then click a map tile to place it.</p>
                  <div id="buildQueue" class="event-rail"></div>
                </div>
              </section>

              <section class="card collapsible-card" id="initiativeHubCard">
                <div class="card-head">
                  <h2>Initiative Console</h2>
                  <button class="btn collapse-btn" data-target="initiativeHubCard">Minimize</button>
                </div>
                <div class="card-body">
                  <p id="initiativeHubHint" class="muted">Use initiatives when demographics are trending down. You spend AP + treasury for direct support.</p>
                  <div class="actions initiative-hub-actions">
                    <button id="initiativeOpenBtn" class="btn">Open Full List</button>
                  </div>
                  <div id="initiativeQuickGrid" class="initiative-quick-grid"></div>
                </div>
              </section>

              <section class="card collapsible-card" id="industryCard">
                <div class="card-head">
                  <h2>Production Economy</h2>
                  <button class="btn collapse-btn" data-target="industryCard">Minimize</button>
                </div>
                <div class="card-body">
                  <p id="industrySummary" class="muted">Build production projects and satisfy dependencies to generate sustained wealth.</p>
                  <div id="industryGuide" class="industry-guide" hidden></div>
                  <div id="foundationGrid" class="foundation-grid"></div>
                  <div id="industryProjects" class="industry-grid"></div>
                </div>
              </section>

              <section class="card selected-card">
                <h2 id="selectedName">Select a Department</h2>
                <p id="selectedDesc" class="muted">Pick a building in the city to inspect funding and upgrades.</p>
                <div class="mini-grid">
                  <div><span>Level</span><strong id="selectedLevel">-</strong></div>
                  <div><span>Budget (Index)</span><strong id="selectedBudget">-</strong></div>
                  <div><span>Status</span><strong id="selectedStatus">-</strong></div>
                  <div><span>Upgrade Cost ($m)</span><strong id="selectedCost">-</strong></div>
                </div>
                <div class="slider-wrap">
                  <label for="budgetSlider">Department Budget Target</label>
                  <input id="budgetSlider" type="range" min="20" max="120" step="1" value="60" />
                  <div class="budget-readout">
                    <div><span>Current</span><strong id="budgetCurrent">-</strong></div>
                    <div><span>Target</span><strong id="budgetTarget">-</strong></div>
                    <div><span>Delta</span><strong id="budgetDelta">-</strong></div>
                    <div><span>Est. Treasury/day</span><strong id="budgetImpact">-</strong></div>
                  </div>
                </div>
                <div class="actions">
                  <button id="applyBudgetBtn" class="btn">Apply Target Budget</button>
                  <button id="upgradeBtn" class="btn primary">Upgrade Building</button>
                  <button id="sellBtn" class="btn danger">Sell / Decommission</button>
                </div>
              </section>
            </section>

            <section class="tab-pane" data-pane="incidents">
              <section class="card rapid-card">
                <h2>INCIDENT BRIEF</h2>
                <p id="rapidTitle">No urgent brief right now.</p>
                <p id="rapidBody" class="muted">Critical briefs appear here with short timers.</p>
                <p id="rapidEvidence" class="muted"></p>
                <div class="mini-grid">
                  <div><span>Timer</span><strong id="rapidTimer">-</strong></div>
                  <div><span>Momentum</span><strong id="rapidMomentum">0</strong></div>
                </div>
                <div class="actions rapid-actions">
                  <button id="rapidBtnA" class="btn primary" disabled>Option A</button>
                  <button id="rapidBtnB" class="btn" disabled>Option B</button>
                  <button id="rapidBtnC" class="btn" disabled>Option C</button>
                </div>
              </section>
              <section class="card">
                <h3>Incident Inbox</h3>
                <div id="incidentInbox" class="mission-list"></div>
              </section>
            </section>

            <section class="tab-pane" data-pane="pulse">
              <section class="card">
                <h3>Ops Radar</h3>
                <p class="muted">At-a-glance system heat and demographic direction.</p>
                <div class="ops-radar-wrap">
                  <svg id="opsRadarSvg" viewBox="0 0 220 220" class="ops-radar" aria-label="Operations radar"></svg>
                  <div id="opsHeatList" class="ops-heat-list"></div>
                </div>
                <div id="pulseMiniBoard" class="pulse-mini-board"></div>
              </section>

              <section class="card">
                <h3>City Pulse</h3>
                <div id="kpiGrid" class="kpi-grid"></div>
              </section>

              <section class="card collapsible-card" id="advisorCard">
                <div class="card-head">
                  <h3>Monthly Advisor Brief</h3>
                  <button class="btn collapse-btn" data-target="advisorCard">Minimize</button>
                </div>
                <div class="card-body">
                  <div id="advisorBrief" class="mission-list"></div>
                </div>
              </section>
            </section>

            <section class="tab-pane" data-pane="people">
              <section class="card">
                <h3>People Pulse</h3>
                <p class="muted">How each demographic is reacting to your policy mix.</p>
                <div id="peopleGrid" class="people-grid"></div>
              </section>
              <section class="card" id="initiativesCard">
                <h3>Initiatives</h3>
                <p class="muted">Spend AP and treasury to directly improve social outcomes.</p>
                <div id="initiativeGrid" class="people-grid"></div>
              </section>
            </section>

            <section class="tab-pane" data-pane="missions">
              <section class="card collapsible-card" id="onboardingCard">
                <div class="card-head">
                  <h2>Onboarding</h2>
                  <button class="btn collapse-btn" data-target="onboardingCard">Minimize</button>
                </div>
                <div class="card-body">
                  <p id="sessionGoal" class="muted">Complete first mission set to unlock streak bonuses.</p>
                  <ul id="onboardingList" class="mission-list"></ul>
                </div>
              </section>

              <section class="card collapsible-card" id="missionCard">
                <div class="card-head">
                  <h3>Missions</h3>
                  <button class="btn collapse-btn" data-target="missionCard">Minimize</button>
                </div>
                <div class="card-body">
                  <p id="tierGoal" class="muted"></p>
                  <ul id="missionList" class="mission-list"></ul>
                </div>
              </section>
            </section>
          </div>
        </aside>
      </section>

      <section class="news-strip compact-dock card">
        <div class="dock-head">
          <strong>Live Pulse</strong>
          <span id="dockStatus" class="muted">Monitoring city systems</span>
        </div>
        <div class="dock-grid">
          <div id="dockPeople" class="pulse-mini-board"></div>
          <div class="dock-radar-wrap">
            <svg id="dockRadarSvg" viewBox="0 0 220 220" class="ops-radar" aria-label="Dock operations radar"></svg>
            <div id="dockHeatList" class="ops-heat-list"></div>
          </div>
        </div>
      </section>
    </main>

    <section id="monthlyModal" class="monthly-modal" hidden>
      <article class="monthly-paper">
        <p class="paper-kicker">Monthly Gazette</p>
        <h2 id="monthlyHeadline">The Capital Ledger | Monthly Brief</h2>
        <p id="monthlySubhead" class="muted"></p>
        <p id="monthlyLead" class="paper-lead"></p>
        <div class="paper-cols">
          <div>
            <h3>City Desk</h3>
            <ul id="monthlySummaryList" class="mission-list"></ul>
          </div>
          <div>
            <h3>Voices</h3>
            <ul id="monthlyQuotes" class="mission-list"></ul>
          </div>
        </div>
        <div class="paper-ledger">
          <h3>Decision Impact Ledger</h3>
          <ul id="monthlyDecisionList" class="mission-list"></ul>
        </div>
        <div class="paper-actions">
          <button id="monthlyCloseBtn" class="btn primary">Continue</button>
        </div>
      </article>
    </section>

    <section id="electionModal" class="monthly-modal election-modal" hidden>
      <article class="monthly-paper election-paper">
        <p class="paper-kicker">Election Night</p>
        <h2 id="electionHeadline">Election Result</h2>
        <p id="electionSubhead" class="muted"></p>
        <p id="electionLead" class="paper-lead"></p>
        <div id="electionPollBars" class="election-poll-bars"></div>
        <ul id="electionFacts" class="mission-list"></ul>
        <div class="paper-actions">
          <button id="electionCloseBtn" class="btn primary">Continue</button>
        </div>
      </article>
    </section>

    <section id="gameOverModal" class="monthly-modal game-over-modal" hidden>
      <article class="monthly-paper game-over-paper">
        <p class="paper-kicker">Simulation Ended</p>
        <h2 id="gameOverHeadline">Government Collapse</h2>
        <p id="gameOverReason" class="paper-lead"></p>
        <ul id="gameOverFacts" class="mission-list"></ul>
        <div class="paper-actions">
          <button id="gameOverRestartBtn" class="btn primary">Restart</button>
        </div>
      </article>
    </section>

    <script type="module" src="app.js"></script>
  </body>
</html>
